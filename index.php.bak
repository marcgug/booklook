<?php

$API_KEY = "qpv4dvfpjv26gndsdeufde48";

// set explicit error reporting
error_reporting(E_ERROR | E_WARNING | E_PARSE);

// track execution time
$time_start = microtime(true);

// OpenBook API
$ch = curl_init("http://api.harpercollins.com/api/v3/hcapim?apiname=catalog&format=JSON&authorname=Dahl&apikey=".$API_KEY."");
//$fp = fopen("example_homepage.txt", "w");

//curl_setopt($ch, CURLOPT_FILE, $fp);
curl_setopt($ch, CURLOPT_HEADER, 0);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);


$curl_result = curl_exec($ch);
print_r($curl_result);

$result = json_decode($curl_result, true);

curl_close($ch);

//fclose($fp);

//print_r($result);
?>
<!DOCTYPE html>
<html>
  <head>
    <title>BookSmash Project</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Bootstrap -->
    <link href="css/bootstrap.min.css" rel="stylesheet" media="screen">
  </head>
  <body>
<div class="container-fluid">
  <div class="row-fluid">
    <div class="span2">
			<h1>Book Smash</h1>
    		<p class="lead">
    		Smash up some books yo.
   			</p>
    </div>
    <div class="span10">
    	<br />
    	<table class="table table-bordered table-striped table-condensed">
 			
      <?php foreach ($result["Product_Group"] as $item): ?>
      
      <tr>
      	<td><img src="<?=$item["Products"]["CoverImageURL_Medium"];?>" class="img-rounded"></td>
      	<td><?=$item["Product_Group_Title"];?><br/>
      		Format: <?=$item["Products"]["Format"]?></td>
      	<td><?=$item["Products"]["Author1"];?></td>	
      </tr>
      <?php endforeach; ?>
    	</table>
      <p>Took <?=round((microtime(true) - $time_start),3);?> seconds to execute.</p>
    </div>
  </div>
</div>
</body>
</html>